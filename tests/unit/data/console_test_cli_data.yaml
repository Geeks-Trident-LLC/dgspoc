template_id: unreal.device.os.show.modules.tmpl
adaptor: unreal-device
host: 1.1.1.1

template_snippet: "digits(var_module)  words(var_name)  mixed_word(var_model)  version(var_version)  word(var_status) end(space) -> record"
created_template_cmdline: 'dgs build template "{self.template_snippet}" --template-id="{self.template_id}" --replaced'
cleared_template_cmdline: 'dgs --clear="{self.template_id}"'

base_cmdline: "show modules"

connect_cmdline: "unreal-device connect {self.host}"
release_cmdline: "unreal-device release {self.host}"

################################################################################
################################################################################
user_data_header: |-
  +------------------------------------------------------------------------------+
  | User Test Data:                                                              |
  +------------------------------------------------------------------------------+

template_header: |-
  +------------------------------------------------------------------------------+
  | Template:                                                                    |
  +------------------------------------------------------------------------------+

parsed_result_header: |-
  +------------------------------------------------------------------------------+
  | Parsed Results:                                                              |
  +------------------------------------------------------------------------------+
show_modules_generic_output_with_connect_disconnect_release_connection: |-
  login unreal-device {self.host}@dummy_username:dummy_password
  mmm dd yyyy HH:MM:SS.### for "{device_name}" - UNREAL-DEVICE-AUTHENTICATION-SERVICE-TIMESTAMP
  {device_name} is successfully connected.
  show modules
  mmm dd yyyy HH:MM:SS.### for "{device_name}" - UNREAL-DEVICE-EXECUTION-SERVICE-TIMESTAMP
  Module Name        Model   Version  Status
  ------ ----------- ------- -------- --------
  1      Left Fan    FAN.1A  1.1.0    Running
  2      Right Fan   FAN.2C  1.3.7    Running
  3      Misc Fan    FAN.1A  1.1.0    Off
  4      Top Cooler  C1-AX   2.3.5    Running
  5      Bot Cooler  C1-AX   2.3.5    Running
  logout unreal-device {self.host}
  mmm dd yyyy HH:MM:SS.### for "{device_name}" - UNREAL-DEVICE-AUTHENTICATION-SERVICE-TIMESTAMP
  {device_name} is disconnected.
  UnrealDeviceMessage: +++ Successfully released {self.host} unreal-device.

show_modules_generic_output: |-
  show modules
  mmm dd yyyy HH:MM:SS.### for "{device_name}" - UNREAL-DEVICE-EXECUTION-SERVICE-TIMESTAMP
  Module Name        Model   Version  Status
  ------ ----------- ------- -------- --------
  1      Left Fan    FAN.1A  1.1.0    Running
  2      Right Fan   FAN.2C  1.3.7    Running
  3      Misc Fan    FAN.1A  1.1.0    Off
  4      Top Cooler  C1-AX   2.3.5    Running
  5      Bot Cooler  C1-AX   2.3.5    Running

show_modules_output: |-
  show modules
  May 11 2022 12:22:17.123 for "device798" - UNREAL-DEVICE-EXECUTION-SERVICE-TIMESTAMP
  Module Name        Model   Version  Status
  ------ ----------- ------- -------- --------
  1      Left Fan    FAN.1A  1.1.0    Running
  2      Right Fan   FAN.2C  1.3.7    Running
  3      Misc Fan    FAN.1A  1.1.0    Off
  4      Top Cooler  C1-AX   2.3.5    Running
  5      Bot Cooler  C1-AX   2.3.5    Running
  
show_modules_csv_output: |-
  show modules csv-format
  May 11 2022 12:22:17.123 for "device798" - UNREAL-DEVICE-EXECUTION-SERVICE-TIMESTAMP
  "module","name","model","version","status"
  "1","Left Fan","FAN.1A","1.1.0","Running"
  "2","Right Fan","FAN.2C","1.3.7","Running"
  "3","Misc Fan","FAN.1A","1.1.0","Off"
  "4","Top Cooler","C1-AX","2.3.5","Running"
  "5","Bot Cooler","C1-AX","2.3.5","Running"

show_modules_json_output: |-
  show modules json-format
  May 11 2022 12:22:17.123 for "device798" - UNREAL-DEVICE-EXECUTION-SERVICE-TIMESTAMP
  {"module_info": [
          {"module": "1", "name": "Left Fan", "model": "FAN.1A", "version": "1.1.0", "status": "Running"},
          {"module": "2", "name": "Right Fan", "model": "FAN.2C", "version": "1.3.7", "status": "Running"},
          {"module": "3", "name": "Misc Fan", "model": "FAN.1A", "version": "1.1.0", "status": "Off"},
          {"module": "4", "name": "Top Cooler", "model": "C1-AX", "version": "2.3.5", "status": "Running"},
          {"module": "5", "name": "Bot Cooler", "model": "C1-AX", "version": "2.3.5", "status": "Running"}
      ]
  }

show_modules_generic_template_content: |-
  ################################################################################
  # Template is generated by templateapp Community Edition
  # Created date: yyyy-mm-dd
  ################################################################################
  Value module (\d+)
  Value name ([a-zA-Z0-9]+( [a-zA-Z0-9]+)*)
  Value model (\S*[a-zA-Z0-9]\S*)
  Value version ([0-9]\S*)
  Value status ([a-zA-Z0-9]+)
  
  Start
    ^${module} +${name} +${model} +${version} +${status} *$$ -> Record

show_modules_template_content: |-
  ################################################################################
  # Template is generated by templateapp Community Edition
  # Created date: 2022-05-22
  ################################################################################
  Value module (\d+)
  Value name ([a-zA-Z0-9]+( [a-zA-Z0-9]+)*)
  Value model (\S*[a-zA-Z0-9]\S*)
  Value version ([0-9]\S*)
  Value status ([a-zA-Z0-9]+)
  
  Start
    ^${module} +${name} +${model} +${version} +${status} *$$ -> Record

full_bare_parsed_template_result: |-
  [{'model': 'FAN.1A',
    'module': '1',
    'name': 'Left Fan',
    'status': 'Running',
    'version': '1.1.0'},
   {'model': 'FAN.2C',
    'module': '2',
    'name': 'Right Fan',
    'status': 'Running',
    'version': '1.3.7'},
   {'model': 'FAN.1A',
    'module': '3',
    'name': 'Misc Fan',
    'status': 'Off',
    'version': '1.1.0'},
   {'model': 'C1-AX',
    'module': '4',
    'name': 'Top Cooler',
    'status': 'Running',
    'version': '2.3.5'},
   {'model': 'C1-AX',
    'module': '5',
    'name': 'Bot Cooler',
    'status': 'Running',
    'version': '2.3.5'}]

full_bare_parsed_result_in_ordereddict_format: |-
  [OrderedDict([('module', '1'),
                ('name', 'Left Fan'),
                ('model', 'FAN.1A'),
                ('version', '1.1.0'),
                ('status', 'Running')]),
   OrderedDict([('module', '2'),
                ('name', 'Right Fan'),
                ('model', 'FAN.2C'),
                ('version', '1.3.7'),
                ('status', 'Running')]),
   OrderedDict([('module', '3'),
                ('name', 'Misc Fan'),
                ('model', 'FAN.1A'),
                ('version', '1.1.0'),
                ('status', 'Off')]),
   OrderedDict([('module', '4'),
                ('name', 'Top Cooler'),
                ('model', 'C1-AX'),
                ('version', '2.3.5'),
                ('status', 'Running')]),
   OrderedDict([('module', '5'),
                ('name', 'Bot Cooler'),
                ('model', 'C1-AX'),
                ('version', '2.3.5'),
                ('status', 'Running')])]
  
full_tabular_parsed_template_result: |-
    +--------+------------+--------+---------+---------+
    | module | name       | model  | version | status  |
    +--------+------------+--------+---------+---------+
    | 1      | Left Fan   | FAN.1A | 1.1.0   | Running |
    | 2      | Right Fan  | FAN.2C | 1.3.7   | Running |
    | 3      | Misc Fan   | FAN.1A | 1.1.0   | Off     |
    | 4      | Top Cooler | C1-AX  | 2.3.5   | Running |
    | 5      | Bot Cooler | C1-AX  | 2.3.5   | Running |
    +--------+------------+--------+---------+---------+

full_bare_parsed_json_result: |-
  {'module_info': [{'model': 'FAN.1A',
                    'module': '1',
                    'name': 'Left Fan',
                    'status': 'Running',
                    'version': '1.1.0'},
                   {'model': 'FAN.2C',
                    'module': '2',
                    'name': 'Right Fan',
                    'status': 'Running',
                    'version': '1.3.7'},
                   {'model': 'FAN.1A',
                    'module': '3',
                    'name': 'Misc Fan',
                    'status': 'Off',
                    'version': '1.1.0'},
                   {'model': 'C1-AX',
                    'module': '4',
                    'name': 'Top Cooler',
                    'status': 'Running',
                    'version': '2.3.5'},
                   {'model': 'C1-AX',
                    'module': '5',
                    'name': 'Bot Cooler',
                    'status': 'Running',
                    'version': '2.3.5'}]}


################################################################################
################################################################################
########################### Adaptor is Unreal-Device ###########################
case1:
  cmdline: 'dgs test --adaptor="{self.adaptor}" --action="{self.host} EXECUTE {self.base_cmdline}"'
  expected_result: |-
    {self.show_modules_generic_output_with_connect_disconnect_release_connection}

case2:
  cmdline: 'dgs test --adaptor="{self.adaptor}" --action="{self.host} EXECUTE {self.base_cmdline} USING-TEMPLATE {self.template_id}"'
  expected_result: |-
    {self.show_modules_generic_output_with_connect_disconnect_release_connection}
    {self.parsed_result_header}
    {self.full_bare_parsed_template_result}

case3:
  cmdline: 'dgs test --adaptor="{self.adaptor}" --action="{self.host} EXECUTE {self.base_cmdline} USING-TEMPLATE {self.template_id} --showed --tabular"'
  expected_result: |-
    {self.show_modules_generic_output_with_connect_disconnect_release_connection}
    {self.user_data_header}
    {self.show_modules_generic_output}
    
    {self.template_header}
    {self.show_modules_generic_template_content}
    
    
    {self.parsed_result_header}
    {self.full_tabular_parsed_template_result}

case4:
  cmdline: 'dgs test --adaptor="{self.adaptor}" --action="{self.host} EXECUTE {self.base_cmdline} USING-TEMPLATE {self.template_id} SELECT * WHERE version >= version(2.0.0) --tabular"'
  expected_result: |-
    {self.show_modules_generic_output_with_connect_disconnect_release_connection}
    +------------------------------------------------------------------------------+
    | Parsed Results:                                                              |
    |     SELECT-STATEMENT: SELECT * WHERE version >= version(2.0.0)               |
    +------------------------------------------------------------------------------+
    +--------+------------+-------+---------+---------+
    | module | name       | model | version | status  |
    +--------+------------+-------+---------+---------+
    | 4      | Top Cooler | C1-AX | 2.3.5   | Running |
    | 5      | Bot Cooler | C1-AX | 2.3.5   | Running |
    +--------+------------+-------+---------+---------+
    
case5:
  cmdline: 'dgs test --adaptor="{self.adaptor}" --action="{self.host} EXECUTE {self.base_cmdline} USING-TEMPLATE {self.template_id} SELECT * WHERE version >= version(2.0.0) MUST BE EQUAL_TO 2 --tabular"'
  expected_result: |-
    {self.show_modules_generic_output_with_connect_disconnect_release_connection}
    +------------------------------------------------------------------------------+
    | Parsed Results:                                                              |
    |     SELECT-STATEMENT: SELECT * WHERE version >= version(2.0.0)               |
    +------------------------------------------------------------------------------+
    +--------+------------+-------+---------+---------+
    | module | name       | model | version | status  |
    +--------+------------+-------+---------+---------+
    | 4      | Top Cooler | C1-AX | 2.3.5   | Running |
    | 5      | Bot Cooler | C1-AX | 2.3.5   | Running |
    +--------+------------+-------+---------+---------+
    
    +------------------------------------------------------------------------------+
    | Verification:                                                                |
    |     CONDITION: MUST BE EQUAL_TO 2                                            |
    |     STATUS   : Passed                                                        |
    +------------------------------------------------------------------------------+
    (total found records: 2) == (expected total count: 2)

#################### Adaptor is emtpy, stream, or filename #####################
case1_using_file_syntax1:
  fmt: 'dgs test --action="%s"'
  expected_result: "{self.show_modules_output}"

case1_using_file_syntax2:
  fmt: 'dgs test --action="--filename=%s"'
  expected_result: "{self.show_modules_output}"

case1_using_file_syntax3:
  fmt: 'dgs test --action="dummy EXECUTE %s"'
  expected_result: "{self.show_modules_output}"

case1_using_file_syntax4:
  fmt: 'dgs test --adaptor="stream" --action="%s"'
  expected_result: "{self.show_modules_output}"

case1_using_file_syntax5:
  fmt: 'dgs test --adaptor="filename" --action="%s"'
  expected_result: "{self.show_modules_output}"

case2_using_file_scenario1:
  fmt: 'dgs test --action="%s USING-TEMPLATE --filename=%s"'
  expected_result: |-
    {self.show_modules_output}
    {self.parsed_result_header}
    {self.full_bare_parsed_template_result}

case2_using_file_scenario2:
  fmt: 'dgs test --action="%s USING-TEMPLATE --filename=%s --showed"'
  expected_result: |-
    {self.show_modules_output}
    {self.user_data_header}
    {self.show_modules_output}
    
    {self.template_header}
    {self.show_modules_template_content}
    
    
    {self.parsed_result_header}
    {self.full_bare_parsed_template_result}

case2_using_file_scenario3:
  fmt: 'dgs test --action="%s USING-TEMPLATE --filename=%s --showed --tabular"'
  expected_result: |-
    {self.show_modules_output}
    {self.user_data_header}
    {self.show_modules_output}
    
    {self.template_header}
    {self.show_modules_template_content}
    
    
    {self.parsed_result_header}
    {self.full_tabular_parsed_template_result}

case3_using_file_scenario1:
  fmt: 'dgs test --action="%s USING-CSV"'
  expected_result: |-
    {self.show_modules_csv_output}
    {self.parsed_result_header}
    {self.full_bare_parsed_template_result}
  expected_result_for_py36_py37: |-
    {self.show_modules_csv_output}
    {self.parsed_result_header}
    {self.full_bare_parsed_result_in_ordereddict_format}

case3_using_file_scenario2:
  fmt: 'dgs test --action="%s USING-CSV --showed"'
  expected_result: |-
    {self.show_modules_csv_output}
    {self.user_data_header}
    {self.show_modules_csv_output}
    
    {self.parsed_result_header}
    {self.full_bare_parsed_template_result}
  expected_result_for_py36_py37: |-
    {self.show_modules_csv_output}
    {self.user_data_header}
    {self.show_modules_csv_output}
    
    {self.parsed_result_header}
    {self.full_bare_parsed_result_in_ordereddict_format}

case3_using_file_scenario3:
  fmt: 'dgs test --action="%s USING-CSV --showed --tabular"'
  expected_result: |-
    {self.show_modules_csv_output}
    {self.user_data_header}
    {self.show_modules_csv_output}
    
    {self.parsed_result_header}
    {self.full_tabular_parsed_template_result}

case4_using_file_scenario1:
  fmt: 'dgs test --action="%s USING-JSON"'
  expected_result: |-
    {self.show_modules_json_output}
    {self.parsed_result_header}
    {self.full_bare_parsed_json_result}

case4_using_file_scenario2:
  fmt: 'dgs test --action="%s USING-JSON --showed"'
  expected_result: |-
    {self.show_modules_json_output}
    {self.user_data_header}
    {self.show_modules_json_output}
    
    {self.parsed_result_header}
    {self.full_bare_parsed_json_result}

case5_using_file_scenario1:
  fmt: 'dgs test --action="dummy EXECUTE %s USING-TEMPLATE --filename=%s SELECT * WHERE version >= version(1.0.0) --showed --tabular"'
  expected_result: |-
    {self.show_modules_output}
    {self.user_data_header}
    {self.show_modules_output}
    
    {self.template_header}
    {self.show_modules_template_content}
    
    
    +------------------------------------------------------------------------------+
    | Parsed Results:                                                              |
    |     SELECT-STATEMENT: SELECT * WHERE version >= version(1.0.0)               |
    +------------------------------------------------------------------------------+
    {self.full_tabular_parsed_template_result}

case5_using_file_scenario2:
  fmt: 'dgs test --action="dummy EXECUTE %s USING-TEMPLATE --filename=%s SELECT * WHERE version ge version(1.0.0) --showed --tabular"'
  expected_result: |-
    {self.show_modules_output}
    {self.user_data_header}
    {self.show_modules_output}
    
    {self.template_header}
    {self.show_modules_template_content}
    
    
    +------------------------------------------------------------------------------+
    | Parsed Results:                                                              |
    |     SELECT-STATEMENT: SELECT * WHERE version ge version(1.0.0)               |
    +------------------------------------------------------------------------------+
    {self.full_tabular_parsed_template_result}

case6_using_file_scenario1:
  fmt: 'dgs test --action="dummy EXECUTE %s USING-TEMPLATE --filename=%s SELECT * WHERE version >= version(1.0.0) MUST BE EQUAL_TO 5 --showed --tabular"'
  expected_result: |-
    {self.show_modules_output}
    {self.user_data_header}
    {self.show_modules_output}
    
    {self.template_header}
    {self.show_modules_template_content}
    
    
    +------------------------------------------------------------------------------+
    | Parsed Results:                                                              |
    |     SELECT-STATEMENT: SELECT * WHERE version >= version(1.0.0)               |
    +------------------------------------------------------------------------------+
    {self.full_tabular_parsed_template_result}
    
    +------------------------------------------------------------------------------+
    | Verification:                                                                |
    |     CONDITION: MUST BE EQUAL_TO 5                                            |
    |     STATUS   : Passed                                                        |
    +------------------------------------------------------------------------------+
    (total found records: 5) == (expected total count: 5)

case6_using_file_scenario2:
  fmt: 'dgs test --action="dummy EXECUTE %s USING-TEMPLATE --filename=%s SELECT * WHERE version >= version(1.0.0) MUST BE == 5 --showed --tabular"'
  expected_result: |-
    {self.show_modules_output}
    {self.user_data_header}
    {self.show_modules_output}
    
    {self.template_header}
    {self.show_modules_template_content}
    
    
    +------------------------------------------------------------------------------+
    | Parsed Results:                                                              |
    |     SELECT-STATEMENT: SELECT * WHERE version >= version(1.0.0)               |
    +------------------------------------------------------------------------------+
    {self.full_tabular_parsed_template_result}
    
    +------------------------------------------------------------------------------+
    | Verification:                                                                |
    |     CONDITION: MUST BE == 5                                                  |
    |     STATUS   : Passed                                                        |
    +------------------------------------------------------------------------------+
    (total found records: 5) == (expected total count: 5)

case6_using_file_scenario3:
  fmt: 'dgs test --action="dummy EXECUTE %s USING-TEMPLATE --filename=%s SELECT * WHERE version >= version(1.0.0) MUST BE GREATER_THAN 2 --showed --tabular"'
  expected_result: |-
    {self.show_modules_output}
    {self.user_data_header}
    {self.show_modules_output}
    
    {self.template_header}
    {self.show_modules_template_content}
    
    
    +------------------------------------------------------------------------------+
    | Parsed Results:                                                              |
    |     SELECT-STATEMENT: SELECT * WHERE version >= version(1.0.0)               |
    +------------------------------------------------------------------------------+
    {self.full_tabular_parsed_template_result}
    
    +------------------------------------------------------------------------------+
    | Verification:                                                                |
    |     CONDITION: MUST BE GREATER_THAN 2                                        |
    |     STATUS   : Passed                                                        |
    +------------------------------------------------------------------------------+
    (total found records: 5) > (expected total count: 2)

case6_using_file_scenario4:
  fmt: 'dgs test --action="dummy EXECUTE %s USING-TEMPLATE --filename=%s SELECT * WHERE version >= version(1.0.0) MUST BE LESS_THAN 8 --showed --tabular"'
  expected_result: |-
    {self.show_modules_output}
    {self.user_data_header}
    {self.show_modules_output}
    
    {self.template_header}
    {self.show_modules_template_content}
    
    
    +------------------------------------------------------------------------------+
    | Parsed Results:                                                              |
    |     SELECT-STATEMENT: SELECT * WHERE version >= version(1.0.0)               |
    +------------------------------------------------------------------------------+
    {self.full_tabular_parsed_template_result}
    
    +------------------------------------------------------------------------------+
    | Verification:                                                                |
    |     CONDITION: MUST BE LESS_THAN 8                                           |
    |     STATUS   : Passed                                                        |
    +------------------------------------------------------------------------------+
    (total found records: 5) < (expected total count: 8)

case7_using_file_scenario1:
  fmt: 'dgs test --action="dummy EXECUTE %s USING-TEMPLATE --filename=%s SELECT * WHERE name eq Misc Fan && status == Off MUST BE True --showed --tabular"'
  expected_result: |-
    {self.show_modules_output}
    {self.user_data_header}
    {self.show_modules_output}
    
    {self.template_header}
    {self.show_modules_template_content}
    
    
    +------------------------------------------------------------------------------+
    | Parsed Results:                                                              |
    |     SELECT-STATEMENT: SELECT * WHERE name eq Misc Fan && status == Off       |
    +------------------------------------------------------------------------------+
    +--------+----------+--------+---------+--------+
    | module | name     | model  | version | status |
    +--------+----------+--------+---------+--------+
    | 3      | Misc Fan | FAN.1A | 1.1.0   | Off    |
    +--------+----------+--------+---------+--------+
    
    +------------------------------------------------------------------------------+
    | Verification:                                                                |
    |     CONDITION: MUST BE True                                                  |
    |     STATUS   : Passed                                                        |
    +------------------------------------------------------------------------------+
    (total found records: 1) == (expected total count: 1)

case7_using_file_scenario2:
  fmt: 'dgs test --action="dummy EXECUTE %s USING-TEMPLATE --filename=%s SELECT * WHERE name eq Misc Fan && status == Running MUST BE False --showed --tabular"'
  expected_result: |-
    {self.show_modules_output}
    {self.user_data_header}
    {self.show_modules_output}
    
    {self.template_header}
    {self.show_modules_template_content}
    
    
    +------------------------------------------------------------------------------+
    | Parsed Results:                                                              |
    |     SELECT-STATEMENT: SELECT * WHERE name eq Misc Fan && status == Running   |
    +------------------------------------------------------------------------------+
    []
    
    +------------------------------------------------------------------------------+
    | Verification:                                                                |
    |     CONDITION: MUST BE False                                                 |
    |     STATUS   : Passed                                                        |
    +------------------------------------------------------------------------------+
    (total found records: 0) == (expected total count: 0)